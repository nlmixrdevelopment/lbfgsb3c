<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver. — lbfgsb3c • lbfgsb3c</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver. — lbfgsb3c" />
<meta property="og:description" content="Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lbfgsb3c</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2019.7.16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/lbfgsb3c.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver.</h1>
    
    <div class="hidden name"><code>lbfgsb3c.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Interfacing wrapper for the Nocedal - Morales LBFGSB3 (Fortran) limited memory BFGS solver.</p>
    </div>

    <pre class="usage"><span class='fu'>lbfgsb3c</span>(<span class='no'>par</span>, <span class='no'>fn</span>, <span class='kw'>gr</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>lower</span> <span class='kw'>=</span> -<span class='fl'>Inf</span>, <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='no'>...</span>, <span class='kw'>rho</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>lbfgsb3</span>(<span class='no'>par</span>, <span class='no'>fn</span>, <span class='kw'>gr</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>lower</span> <span class='kw'>=</span> -<span class='fl'>Inf</span>, <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='no'>...</span>, <span class='kw'>rho</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>lbfgsb3f</span>(<span class='no'>par</span>, <span class='no'>fn</span>, <span class='kw'>gr</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>lower</span> <span class='kw'>=</span> -<span class='fl'>Inf</span>, <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='no'>...</span>, <span class='kw'>rho</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>lbfgsb3x</span>(<span class='no'>par</span>, <span class='no'>fn</span>, <span class='kw'>gr</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>lower</span> <span class='kw'>=</span> -<span class='fl'>Inf</span>, <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='no'>...</span>, <span class='kw'>rho</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>par</th>
      <td><p>A parameter vector which gives the initial guesses to
the parameters that will minimize <code>fn</code>. This can be
named, for example, we could use par=c(b1=1, b2=2.345,
b3=0.123)</p></td>
    </tr>
    <tr>
      <th>fn</th>
      <td><p>A function that evaluates the objective function to be
minimized.  This can be a R function or a Rcpp function
pointer.</p></td>
    </tr>
    <tr>
      <th>gr</th>
      <td><p>If present, a function that evaluates the gradient
vector for the objective function at the given parameters
computing the elements of the sum of squares function at the
set of parameters <code>start</code>. This can be a R function or a
Rcpp function pointer.</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>Lower bounds on the parameters. If a single number,
this will be applied to all parameters. Default -Inf.</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>Upper bounds on the parameters. If a single number,
this will be applied to all parameters. Default Inf.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>An optional list of control settings. See below in
details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any data needed for computation of the objective
function and gradient.</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>An Environment to use for function evaluation.  If
present the arguments in ... are ignored.  Otherwise the
... are converted to an environment for evaluation.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of the following items</p><ul>
<li><p>par The best set of parameters found.</p></li>
<li><p>value The value of fn corresponding to par.</p></li>
<li><p>counts A two-element integer vector giving the number of calls to fn and gr respectively. This excludes any calls to fn to compute a finite-difference approximation to the gradient.</p></li>
<li><p>convergence An integer code. 0 indicates successful completion</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See the notes below for a general appreciation of this package.</p>
<p>The control list can contain:</p><ul>
<li><p>trace If positive, tracing information on the progress of the optimization is produced. Higher values may produce more tracing information: for method "L-BFGS-B" there are six levels of tracing. (To understand exactly what these do see the source code: higher levels give more detail.)</p></li>
<li><p>factr controls the convergence of the "L-BFGS-B" method. Convergence occurs when the reduction in the objective is within this factor of the machine tolerance. Default is 1e7, that is a tolerance of about 1e-8.</p></li>
<li><p>pgtol helps control the convergence of the "L-BFGS-B" method. It is a tolerance on the projected gradient in the current search direction. This defaults to zero, when the check is suppressed.</p></li>
<li><p>abstol helps control the convergence of the "L-BFGS-B" method. It is an absolute tolerance difference in x values. This defaults to zero, when the check is suppressed.</p></li>
<li><p>reltol helps control the convergence of the "L-BFGS-B" method. It is an relative tolerance difference in x values. This defaults to zero, when the check is suppressed.</p></li>
<li><p>lmm is an integer giving the number of BFGS updates retained in the "L-BFGS-B" method, It defaults to 5.</p></li>
<li><p>maxit maximum number of iterations.</p></li>
<li><p>iprint If positive, tracing information on the progress of the optimization is produced. Higher values may produce more tracing information: for method "L-BFGS-B" there are six levels of tracing. (To understand exactly what these do see the source code: higher levels give more detail.)</p></li>
<li><p>info a boolean to indicate if more optimization information is captured and output in a $info list</p></li>
</ul>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This package is a wrapper to the Fortran code released by Nocedal and Morales.
  This poses several difficulties for an R package. While the <code><a href='https://rdrr.io/r/base/Foreign.html'>.Fortran()</a></code>
  tool exists for the interfacing, we must be very careful to align the arguments
  with those of the Fortran subroutine, especially in type and storage.</p>
<p>A more annoying task for interfacing the Fortran code is that Fortran WRITE or
  PRINT statements must all be replaced with calls to special R-friendly output
  routines. Unfortunately, the Fortran is full of output statements. Worse, we may
  wish to be able to suppress such output, and there are thus many modifications
  to be made. This means that an update of the original code cannot be simply
  plugged into the R package <code>src</code> directory.</p>
<p>Finally, and likely because L-BFGS-B has a long history, the Fortran code is far
  from well-structured. For example, the number of function and gradient evaluations
  used is returned as the 34'th element of an integer vector. There does not appear
  to be an easy way to stop the program after some maximum number of such evaluations
  have been performed.</p>
<p>On the other hand, the version of L-BFGS-B in <code><a href='https://rdrr.io/r/stats/optim.html'>optim()</a></code> is a <code>C</code> translation
  of a now-lost Fortran code. It does not implement the improvements Nocedal and
  Morales published in 2011. Hence, despite its deficiencies, this wrapper has been
  prepared.</p>
<p>In addition to the above reasons for the original lbfgsb3 package,
this additional package allows C calling of L-BFGS-B 3.0 by a
program as well as adjustments to the tolerances that were not
present in the original CRAN package.  Also adjustments were made
to have outputs conform with R's optim routine.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Morales, J. L.; Nocedal, J. (2011). "Remark on 'algorithm 778: L-BFGS-B:
          Fortran subroutines for large-scale bound constrained optimization' ".
          ACM Transactions on Mathematical Software 38: 1.</p>
<p>Byrd, R. H.; Lu, P.; Nocedal, J.; Zhu, C. (1995). "A Limited Memory Algorithm
          for Bound Constrained Optimization". SIAM J. Sci. Comput. 16 (5): 1190-1208.</p>
<p>Zhu, C.; Byrd, Richard H.; Lu, Peihuang; Nocedal, Jorge (1997). "L-BFGS-B:
          Algorithm 778: L-BFGS-B, FORTRAN routines for large scale bound constrained
          optimization". ACM Transactions on Mathematical Software 23 (4): 550-560.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Packages <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> and <code>optimx</code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Rosenbrock's banana function</span>
<span class='no'>n</span><span class='kw'>=</span><span class='fl'>3</span>; <span class='no'>p</span><span class='kw'>=</span><span class='fl'>100</span>

<span class='no'>fr</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>)
{
    <span class='no'>f</span><span class='kw'>=</span><span class='fl'>1.0</span>
    <span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>2</span>:<span class='no'>n</span>) {
        <span class='no'>f</span><span class='kw'>=</span><span class='no'>f</span>+<span class='no'>p</span>*(<span class='no'>x</span>[<span class='no'>i</span>]-<span class='no'>x</span>[<span class='no'>i</span>-<span class='fl'>1</span>]**<span class='fl'>2</span>)**<span class='fl'>2</span>+(<span class='fl'>1.0</span>-<span class='no'>x</span>[<span class='no'>i</span>])**<span class='fl'>2</span>
    }
    <span class='no'>f</span>
}

<span class='no'>grr</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>)
{
    <span class='no'>g</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>double</a></span>(<span class='no'>n</span>)
    <span class='no'>g</span>[<span class='fl'>1</span>]<span class='kw'>=</span>-<span class='fl'>4.0</span>*<span class='no'>p</span>*(<span class='no'>x</span>[<span class='fl'>2</span>]-<span class='no'>x</span>[<span class='fl'>1</span>]**<span class='fl'>2</span>)*<span class='no'>x</span>[<span class='fl'>1</span>]
    <span class='kw'>if</span>(<span class='no'>n</span><span class='kw'>&gt;</span><span class='fl'>2</span>) {
        <span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>2</span>:(<span class='no'>n</span>-<span class='fl'>1</span>)) {
            <span class='no'>g</span>[<span class='no'>i</span>]<span class='kw'>=</span><span class='fl'>2.0</span>*<span class='no'>p</span>*(<span class='no'>x</span>[<span class='no'>i</span>]-<span class='no'>x</span>[<span class='no'>i</span>-<span class='fl'>1</span>]**<span class='fl'>2</span>)-<span class='fl'>4.0</span>*<span class='no'>p</span>*(<span class='no'>x</span>[<span class='no'>i</span>+<span class='fl'>1</span>]-<span class='no'>x</span>[<span class='no'>i</span>]**<span class='fl'>2</span>)*<span class='no'>x</span>[<span class='no'>i</span>]-<span class='fl'>2.0</span>*(<span class='fl'>1.0</span>-<span class='no'>x</span>[<span class='no'>i</span>])
        }
    }
    <span class='no'>g</span>[<span class='no'>n</span>]<span class='kw'>=</span><span class='fl'>2.0</span>*<span class='no'>p</span>*(<span class='no'>x</span>[<span class='no'>n</span>]-<span class='no'>x</span>[<span class='no'>n</span>-<span class='fl'>1</span>]**<span class='fl'>2</span>)-<span class='fl'>2.0</span>*(<span class='fl'>1.0</span>-<span class='no'>x</span>[<span class='no'>n</span>])
    <span class='no'>g</span>
}
<span class='no'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>1.02</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='fl'>1.02</span>, <span class='kw'>c</span><span class='kw'>=</span><span class='fl'>1.02</span>)
(<span class='no'>opc</span> <span class='kw'>&lt;-</span> <span class='fu'>lbfgsb3c</span>(<span class='no'>x</span>,<span class='no'>fr</span>, <span class='no'>grr</span>))</div><div class='output co'>#&gt; $par
#&gt;        a        b        c 
#&gt; 1.000041 1.000083 1.000169 
#&gt; 
#&gt; $grad
#&gt;             a             b             c 
#&gt; -0.0002752393 -0.0006637576  0.0008213517 
#&gt; 
#&gt; $value
#&gt; [1] 1
#&gt; 
#&gt; $counts
#&gt; [1] 21 21
#&gt; 
#&gt; $convergence
#&gt; [1] 0
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"
#&gt; </div><div class='input'>(<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'>lbfgsb3</span>(<span class='no'>x</span>,<span class='no'>fr</span>, <span class='no'>grr</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>trace</span><span class='kw'>=</span><span class='fl'>1</span>)))</div><div class='output co'>#&gt; At iteration 0 f=1.084032 
#&gt; At iteration 2 f=144.115766 
#&gt; At iteration 3 f=1.003318 
#&gt; At iteration 4 f=1.000877 
#&gt; At iteration 5 f=1.000876 
#&gt; At iteration 6 f=1.000866 
#&gt; At iteration 7 f=1.000863 
#&gt; At iteration 8 f=1.000853 
#&gt; At iteration 9 f=1.000707 
#&gt; At iteration 10 f=1.000295 
#&gt; At iteration 11 f=1.080517 
#&gt; At iteration 12 f=1.000158 
#&gt; At iteration 13 f=1.000142 
#&gt; At iteration 14 f=1.000088 
#&gt; At iteration 15 f=1.000277 
#&gt; At iteration 16 f=1.000033 
#&gt; At iteration 17 f=1.000001 
#&gt; At iteration 18 f=1.000000 
#&gt; At iteration 19 f=1.000000 
#&gt; At iteration 20 f=1.000000 
#&gt; At iteration 21 f=1.000000 </div><div class='output co'>#&gt; $par
#&gt;        a        b        c 
#&gt; 1.000041 1.000083 1.000169 
#&gt; 
#&gt; $grad
#&gt;             a             b             c 
#&gt; -0.0002752393 -0.0006637576  0.0008213517 
#&gt; 
#&gt; $value
#&gt; [1] 1
#&gt; 
#&gt; $counts
#&gt; [1] 21 21
#&gt; 
#&gt; $convergence
#&gt; [1] 0
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"
#&gt; 
#&gt; $info
#&gt; $info$task
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"
#&gt; 
#&gt; $info$itask
#&gt; [1] 8
#&gt; 
#&gt; $info$lsave
#&gt; [1] FALSE FALSE FALSE  TRUE
#&gt; 
#&gt; $info$icsave
#&gt; [1] 6
#&gt; 
#&gt; $info$dsave
#&gt;  [1]  1.170212e+03  1.000000e+00  2.220446e-09  1.634496e-06  2.220446e-16
#&gt;  [6]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
#&gt; [11] -1.103432e-09  1.000000e+10  8.213517e-04  1.000000e+00 -1.411118e-09
#&gt; [16]  2.671576e-12 -1.411118e-09 -1.411118e-12 -1.411118e-09 -1.411118e-09
#&gt; [21]  1.000000e+00  1.000000e+00  1.000000e+00  0.000000e+00  0.000000e+00
#&gt; [26]  0.000000e+00  5.000000e+00  1.000000e+10  2.000000e+10
#&gt; 
#&gt; $info$isave
#&gt;  [1]  3  1  4  1  4  7  8  9 10 14 18 21 24 27 30 33  0  0  0  0  0  1  0  8  0
#&gt; [26]  0  1  1  1 14 13  0  0 21  0  1  0  3  0  4  0  0  0  1
#&gt; 
#&gt; </div><div class='input'>(<span class='no'>opx</span> <span class='kw'>&lt;-</span> <span class='fu'>lbfgsb3x</span>(<span class='no'>x</span>,<span class='no'>fr</span>, <span class='no'>grr</span>))</div><div class='output co'>#&gt; $par
#&gt;        a        b        c 
#&gt; 1.000041 1.000083 1.000169 
#&gt; 
#&gt; $grad
#&gt;             a             b             c 
#&gt; -0.0002752393 -0.0006637576  0.0008213517 
#&gt; 
#&gt; $value
#&gt; [1] 1
#&gt; 
#&gt; $counts
#&gt; [1] 21 21
#&gt; 
#&gt; $convergence
#&gt; [1] 0
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"
#&gt; </div><div class='input'>(<span class='no'>opf</span> <span class='kw'>&lt;-</span> <span class='fu'>lbfgsb3f</span>(<span class='no'>x</span>,<span class='no'>fr</span>, <span class='no'>grr</span>))</div><div class='output co'>#&gt; $par
#&gt;        a        b        c 
#&gt; 1.000041 1.000083 1.000169 
#&gt; 
#&gt; $grad
#&gt;             a             b             c 
#&gt; -0.0002752393 -0.0006637576  0.0008213517 
#&gt; 
#&gt; $value
#&gt; [1] 1
#&gt; 
#&gt; $counts
#&gt; [1] 21 21
#&gt; 
#&gt; $convergence
#&gt; [1] 0
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"
#&gt; 
#&gt; $info
#&gt; $info$task
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH"
#&gt; 
#&gt; $info$itask
#&gt; [1] 8
#&gt; 
#&gt; $info$lsave
#&gt; [1] FALSE FALSE FALSE  TRUE
#&gt; 
#&gt; $info$icsave
#&gt; [1] 6
#&gt; 
#&gt; $info$dsave
#&gt;  [1]  1.170212e+03  1.000000e+00  2.220446e-09  1.634496e-06  2.220446e-16
#&gt;  [6]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
#&gt; [11] -1.103432e-09  1.000000e+10  8.213517e-04  1.000000e+00 -1.411118e-09
#&gt; [16]  2.671576e-12 -1.411118e-09 -1.411118e-12 -1.411118e-09 -1.411118e-09
#&gt; [21]  1.000000e+00  1.000000e+00  1.000000e+00  0.000000e+00  0.000000e+00
#&gt; [26]  0.000000e+00  5.000000e+00  1.000000e+10  2.000000e+10
#&gt; 
#&gt; $info$isave
#&gt;  [1]  3  1  4  1  4  7  8  9 10 14 18 21 24 27 30 33  0  0  0  0  0  1  0  8  0
#&gt; [26]  0  1  1  1 14 13  0  0 21  0  1  0  3  0  4  0  0  0  1
#&gt; 
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Matthew Fidler (move to C and add more options for adjustments),
    John C Nash &lt;nashjc@uottawa.ca&gt; (of the wrapper and edits to Fortran code to allow R output)
    Ciyou Zhu, Richard Byrd, Jorge Nocedal, Jose Luis Morales (original Fortran packages)</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matthew L Fidler, John C Nash, Ciyou Zhu, Richard Byrd, Jorge Nocedal, Jose Luis Morales.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


